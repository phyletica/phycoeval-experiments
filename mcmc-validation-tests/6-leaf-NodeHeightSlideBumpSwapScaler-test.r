#! /usr/bin/env Rscript

# test_general_tree_topo_operators.cpp
# NodeHeightSlideBumpSwapScaler< BaseTree<Node> > op;
# op.set_operate_on_root(true);
# unsigned int niterations = 20000000;
# unsigned int sample_freq = 20;

# plot_binom_on_hist <- function(counts, p) {
#     k = seq(from = min(counts), to = max(counts), by = 1)
#     n = sum(counts)
#     binom_probs = dbinom(k, n, p)
#     hist(counts, freq = F)
#     lines(k, binom_probs, type = 'l')
# }

counts = c(1063, 1099, 1047, 1063, 1016, 1040, 1101, 1087, 1088, 1054, 1063, 1063, 1005, 1060, 1066, 1015, 1020, 1120, 1088, 1031, 1018, 1032, 1063, 999, 1032, 1026, 1072, 1064, 1067, 1062, 1051, 982, 1080, 1126, 1049, 1069, 1060, 1072, 1066, 1101, 1130, 1058, 1111, 1055, 1106, 1026, 1006, 1053, 1140, 1096, 1094, 1013, 1083, 1028, 1031, 1089, 1040, 1043, 1082, 1088, 1036, 1096, 1014, 1062, 1021, 1065, 1065, 1066, 1108, 1047, 992, 1060, 1061, 1042, 1123, 1105, 1052, 1020, 1113, 1006, 1087, 1003, 1054, 1065, 1049, 1066, 1065, 1057, 1022, 1094, 1031, 1075, 1014, 1054, 1059, 1060, 1093, 1027, 1027, 1057, 1035, 1047, 1056, 1059, 1042, 1040, 1088, 1064, 1109, 1041, 1052, 1016, 1078, 1045, 984, 1037, 1068, 1054, 1022, 1048, 1122, 1058, 1054, 1060, 1123, 1062, 1073, 1072, 1054, 1030, 1054, 1056, 1094, 990, 1088, 1030, 1084, 1102, 1065, 1054, 1096, 1101, 1029, 1080, 1071, 1105, 1064, 1098, 1013, 999, 1039, 1077, 1033, 1059, 1043, 1070, 1084, 1132, 1049, 1049, 1061, 1051, 1111, 1090, 1038, 1039, 1065, 1078, 1058, 1061, 1031, 1035, 1096, 1080, 1079, 1044, 1114, 1095, 1050, 1080, 1049, 971, 1044, 1088, 1080, 1034, 1019, 1030, 1104, 1014, 1055, 1066, 1044, 1049, 1051, 1033, 1127, 1129, 1026, 1007, 1106, 1051, 1050, 1043, 1057, 1096, 1070, 1038, 1032, 1073, 1129, 1040, 1031, 1102, 1014, 1122, 1126, 1071, 1079, 1082, 1031, 1004, 1079, 1075, 1077, 1057, 1026, 1055, 1079, 1052, 1076, 1051, 1054, 1056, 1095, 1036, 1092, 1028, 1086, 1032, 1031, 1121, 1096, 1074, 1035, 1099, 1084, 1025, 1069, 1104, 1102, 1095, 1077, 1075, 1045, 1145, 1078, 1084, 972, 1032, 1079, 1042, 1107, 1067, 1041, 1049, 1070, 1096, 1052, 1163, 1088, 1062, 1032, 1130, 1093, 1099, 1049, 1121, 1021, 1042, 1033, 1058, 1002, 1057, 1056, 1074, 1064, 1059, 1095, 1107, 1094, 1043, 1028, 1023, 1058, 1054, 1042, 1056, 1099, 1044, 1030, 1060, 1048, 1051, 1020, 1078, 1053, 998, 1056, 1033, 1023, 1037, 1049, 997, 1049, 1083, 1058, 1053, 1052, 1064, 1037, 1057, 1081, 1055, 1117, 1055, 1064, 1039, 985, 1088, 1127, 1127, 1081, 1048, 1081, 1038, 1076, 1039, 1097, 1078, 1144, 1049, 1118, 1125, 1109, 1022, 1061, 1000, 1088, 1128, 1112, 996, 1037, 1085, 1052, 1017, 1004, 1077, 1050, 1054, 1012, 1053, 1061, 1034, 1114, 1055, 1050, 959, 1027, 1013, 1062, 1023, 1113, 1037, 1082, 1069, 1084, 1124, 1062, 1101, 1033, 1090, 1023, 1074, 982, 1130, 1024, 1111, 1080, 1082, 1079, 1069, 1105, 1042, 1069, 1072, 1050, 1057, 1102, 1046, 1054, 1004, 1060, 1050, 1093, 1033, 1101, 1020, 1075, 1068, 1091, 1060, 1055, 1089, 1092, 1042, 1104, 1025, 1070, 1088, 1093, 1064, 1086, 1056, 1068, 972, 1060, 1076, 1037, 1076, 1119, 1075, 1086, 1066, 1075, 996, 1048, 1096, 1028, 1140, 1086, 1124, 1071, 1069, 1018, 1074, 1073, 1075, 1068, 1053, 1043, 1040, 1089, 1059, 1081, 1047, 1038, 1047, 1064, 1056, 1015, 1026, 1023, 1009, 1050, 1063, 1074, 1057, 1030, 1064, 1073, 1055, 1014, 1069, 1061, 1102, 1081, 1118, 1025, 1046, 1108, 1032, 1063, 1014, 1030, 1082, 1018, 1031, 1091, 1031, 1059, 1005, 1047, 1043, 1037, 1054, 1007, 1074, 1076, 1044, 1077, 1076, 1100, 1085, 1067, 1087, 1104, 1092, 1064, 1063, 1040, 1097, 1029, 1048, 1007, 1068, 1016, 1016, 1071, 1057, 1017, 1103, 1086, 1020, 1007, 1063, 1075, 1066, 1052, 1076, 1154, 1138, 1033, 1092, 1059, 1069, 1076, 1041, 1075, 1040, 1042, 1057, 1043, 1096, 1081, 1058, 1107, 1008, 1126, 1104, 1058, 1097, 1072, 1066, 1072, 1089, 1087, 978, 1086, 1073, 1119, 1109, 1030, 1067, 1029, 1080, 1059, 1048, 1028, 1069, 1094, 1101, 1069, 1080, 1107, 1092, 1011, 1077, 1040, 1024, 1056, 1032, 1045, 1050, 1074, 1050, 1004, 1088, 1045, 1063, 1024, 1092, 1089, 1076, 1074, 1080, 1007, 1113, 1100, 1023, 1048, 1080, 1069, 1025, 1029, 1021, 1111, 1044, 1002, 1013, 997, 1049, 1018, 1094, 1079, 1060, 982, 1057, 1062, 985, 1057, 1025, 995, 1008, 1042, 1071, 1050, 1087, 1022, 1062, 1058, 1048, 1092, 1019, 1052, 1026, 1068, 1015, 1049, 1050, 1105, 1016, 1088, 1059, 1043, 1052, 1040, 1142, 1004, 1010, 1016, 1113, 1027, 1084, 1045, 1055, 1073, 1016, 1093, 1068, 1041, 1079, 1034, 1010, 1045, 1083, 1053, 1078, 1048, 1077, 1055, 1021, 991, 1105, 1013, 1080, 1027, 1092, 1045, 1086, 1034, 1033, 1068, 1036, 1018, 1064, 1018, 1144, 1068, 1094, 1045, 1084, 1080, 1014, 1054, 1058, 1083, 1016, 1052, 1051, 1068, 1097, 978, 1025, 1019, 1061, 1011, 1118, 1074, 1010, 1013, 1053, 1110, 1094, 1098, 1071, 1053, 1068, 1040, 1015, 1096, 1085, 1050, 1055, 1089, 1026, 1056, 1036, 1032, 1057, 1050, 1077, 1017, 1072, 1045, 1029, 1010, 1062, 1057, 1072, 1043, 1068, 1049, 1062, 1081, 1070, 1091, 968, 1044, 1101, 1011, 1059, 1059, 1056, 1059, 1099, 1043, 1078, 1090, 1014, 1094, 1032, 1036, 998, 1007, 1064, 1029, 1046, 1073, 1030, 1078, 1109, 1072, 1076, 1046, 1051, 1031, 1088, 1081, 1041, 1041, 1022, 972, 1067, 1049, 1093, 1059, 1033, 983, 1021, 1037, 1025, 1067, 1091, 1003, 1079, 1045, 1028, 1024, 1040, 1059, 1039, 989, 1029, 1119, 1092, 1056, 1075, 1070, 1047, 1072, 1050, 1068, 1062, 1068, 1066, 1113, 1057, 1119, 1031, 1039, 1007, 1016, 1052, 1094, 1036, 1065, 1036, 1113, 1066, 1069, 1038, 1054, 1104, 1095, 1089, 1048, 1056, 1061, 1118, 1080, 1021, 1085, 1088, 983, 1063, 1126, 1105, 1056, 1052, 1063, 1027, 1018, 1058, 1083, 1077, 1030, 1102, 1053, 1127, 1062, 1009, 1054, 1082, 1030, 1033, 1003, 1065, 1061, 1037, 1014, 1076, 1077, 1069, 1052, 1034, 1020, 1076, 1047, 1092, 1096, 1023, 1064, 1077, 998, 1054, 1065, 1065, 1022, 1092, 1083, 1021, 1038, 1096, 978, 1018, 1091, 1126, 967, 1061, 1056, 1046, 1071, 1063, 1011, 1020, 1053, 987, 1062, 1084, 1060, 1042, 1060, 1021, 1042, 1085, 984, 1071, 1013, 1029, 1090, 1111, 1021, 1087, 1033, 1033, 1068, 996, 1073, 1033, 1052, 1052, 1034, 1032, 1027, 1032, 1042, 952, 1016, 1060, 1062, 1073, 1071, 1046, 1057)
number_of_topologies = length(counts)
binomial_prob = 1.0 / number_of_topologies
topology = seq(from = 1, to = number_of_topologies, by = 1)
d = data.frame(topology = topology, count = counts)

# pdf("6-leaf-NodeHeightSlideBumpSwapScaler-test-topo-vs-count.pdf")
# plot(x = d$topology, y = d$count, ylim = c(0, max(counts)))
# dev.off()

# pdf("6-leaf-NodeHeightSlideBumpSwapScaler-test-count-distribution.pdf")
# plot_binom_on_hist(counts = counts, p = binomial_prob)
# dev.off()

# chisq.test(counts)
