#! /usr/bin/env Rscript

# test_general_tree_rj_operator.cpp
# SplitLumpNodesRevJumpSampler< BaseTree<Node> > op;
# unsigned int niterations = 50000000;
# unsigned int sample_freq = 50;

# plot_binom_on_hist <- function(counts, p) {
#     k = seq(from = min(counts), to = max(counts), by = 1)
#     n = sum(counts)
#     binom_probs = dbinom(k, n, p)
#     hist(counts, freq = F)
#     lines(k, binom_probs, type = 'l')
# }

counts = c(3017, 2930, 2975, 2909, 3025, 2951, 3083, 3063, 3003, 2876, 2927, 2908, 3095, 3005, 3037, 2925, 2978, 2970, 2922, 2966, 2897, 3017, 3000, 3011, 2914, 2941, 2893, 3000, 3030, 2954, 2953, 2975, 3017, 2965, 3020, 2983, 2898, 2952, 3009, 2998, 2990, 2992, 3137, 2964, 2986, 2950, 3055, 2973, 2988, 2991, 3042, 3009, 2939, 2913, 2987, 3001, 3038, 3017, 2988, 3008, 2957, 2933, 2984, 2980, 2923, 3023, 2885, 2974, 2972, 3039, 2922, 2926, 2981, 2899, 3030, 3003, 2978, 2974, 3002, 2950, 2954, 3095, 2922, 3036, 2948, 2844, 3046, 2966, 2942, 2914, 3001, 3010, 3001, 2946, 2955, 2946, 3026, 3044, 2983, 2979, 3010, 2931, 2929, 2971, 3036, 3031, 2948, 3000, 3048, 3020, 3038, 2981, 2971, 2997, 3096, 3049, 2956, 3013, 2931, 2905, 2875, 2971, 2998, 2906, 2971, 3058, 2900, 2986, 3015, 2963, 2970, 2898, 3070, 2995, 2930, 2928, 3083, 2929, 2969, 2993, 3040, 2922, 2887, 2958, 2920, 3015, 2906, 2973, 3015, 2985, 3013, 3005, 2983, 2971, 3018, 2919, 2966, 2975, 3003, 2992, 3101, 3075, 2970, 2922, 2957, 2989, 2896, 2948, 2992, 3102, 2956, 3005, 2997, 3087, 2946, 2991, 2891, 2894, 2944, 2921, 2945, 3004, 3089, 2985, 2977, 2986, 2961, 3020, 3002, 2980, 2976, 3002, 2934, 2924, 2964, 3043, 2905, 2832, 2967, 2926, 2924, 2993, 3043, 2947, 3000, 2930, 2820, 2887, 2923, 3042, 2981, 2989, 2934, 2932, 2952, 2947, 2911, 2922, 3021, 2930, 3090, 2941, 2915, 2902, 2953, 2978, 2963, 2915, 2897, 3070, 3016, 3046, 3038, 2920, 2970, 2999, 2974, 3057, 2950, 2969, 2921, 2944, 2945, 2987, 2988, 3003, 2990, 3021, 2969, 3071, 3059, 3070, 2947, 2933, 2944, 3024, 2958, 2931, 3014, 2989, 2982, 3024, 2903, 3000, 2936, 3034, 2970, 2968, 3013, 2948, 2965, 3036, 2982, 2932, 3013, 2869, 2988, 3019, 2983, 3032, 2919, 2916, 2919, 2967, 3022, 2906, 2967, 2941, 3018, 2991, 2976, 3033, 3017, 2936, 3041, 2902, 2884, 2995, 2850, 3019, 3068, 2962, 2902, 2951, 3021, 2940, 3036, 2970, 2821, 2923, 2924, 3007, 3024, 3076, 3048, 2933, 2917, 2928, 3004, 2984, 3078, 2935, 3014, 2950, 3030, 2960, 3018, 3038, 2948, 2973, 2979, 3063, 3007, 2981, 2978, 2900)
number_of_topologies = length(counts)
binomial_prob = 1.0 / number_of_topologies
topology = seq(from = 1, to = number_of_topologies, by = 1)
d = data.frame(topology = topology, count = counts)

# pdf("5-leaf-general-tree-test-topo-vs-count.pdf")
# plot(x = d$topology, y = d$count, ylim = c(0, max(counts)))
# dev.off()

# pdf("5-leaf-general-tree-test-count-distribution.pdf")
# plot_binom_on_hist(counts = counts, p = binomial_prob)
# dev.off()

# chisq.test(counts)
